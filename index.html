<!DOCTYPE>
<html>
	<head>
		<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css"/>
		<style type="text/css">
			.unselect{
				user-drag: none; 
				user-select: none;
				-moz-user-select: none;
				-webkit-user-drag: none;
				-webkit-user-select: none;
				-ms-user-select: none;
			}
			.zoom{
				zoom: 1.5;
			    -moz-transform:scale(1.5);
			    -moz-transform-origin: 0 0;
			    -o-transform: scale(1.5);
			    -o-transform-origin: 0 0;
			    -webkit-transform: scale(1.5);
			    -webkit-transform-origin: 0 0;
			}
		</style>
	</head>
	<body >
		<div class="container-fluid">			
			<center><h3>Niteco singnature -- for Outlook</h3></center>
			<hr>
			<div class="row">
				<div class="col-md-6">
					<form class="form-horizontal">
						<div class="form-group">
						  <label class="control-label col-md-3" for="full-name">Full name:</label>
						  <div class="col-md-9">
						    <input type="text" id="full-name" name="full-name" class="form-control" placeholder="Enter full name" autocomplete="off" target="#ni-full-name"/>
						  </div>
						</div>

						<div class="form-group">
						  <label class="control-label col-md-3" for="job-title">Job title:</label>
						  <div class="col-md-9">
						    <input type="text" id="job-title" name="job-title" class="form-control" placeholder="Enter job title" autocomplete="off" target="#ni-job-title"/>
						  </div>
						</div>

						<div class="form-group">
						  <label class="control-label col-md-3" for="mobile">Mobile:</label>
						  <div class="col-md-9">
						    <input type="tel" id="mobile" name="mobile" class="form-control" placeholder="Enter mobile" autocomplete="off" target="#ni-mobile"/>
						  </div>
						</div>

						<div class="form-group">
						  <label class="control-label col-md-3" for="email">Email:</label>
						  <div class="col-md-9">
						    <input type="email" id="email" name="email" class="form-control" placeholder="Enter email" autocomplete="off" target="#ni-email"/>
						  </div>
						</div>

						<div class="form-group">
						  <label class="control-label col-md-3" for="skype">Skype:</label>
						  <div class="col-md-9">
						    <input type="text" id="skype" name="skype" class="form-control" placeholder="Enter skype" autocomplete="off" target="#ni-skype"/>
						  </div>
						</div>

						<div class="form-group">
						  <label class="control-label col-md-3" for="company-name">Company name:</label>
						  <div class="col-md-9">
						    <input type="text" id="company-name" name="company-name" class="form-control" placeholder="Enter company name" autocomplete="off" target="#ni-company-name"/>
						  </div>
						</div>

						<div class="form-group">
						  <label class="control-label col-md-3" for="company-address">Company address:</label>
						  <div class="col-md-9">
						    <input type="text" id="company-address" name="company-address" class="form-control" placeholder="Enter company address" autocomplete="off" target="#ni-company-address"/>
						  </div>
						</div>
						
						<div class="form-group">
						  <label class="control-label col-md-3" for="company-phone">Company phone:</label>
						  <div class="col-md-9">
						    <input type="text" id="company-phone" name="company-phone" class="form-control" placeholder="Enter company phone" autocomplete="off" target="#ni-company-phone"/>
						  </div>
						</div>

						<div class="form-group">        
						  <div class="col-md-offset-3 col-md-9">
						    <button type="button" id="download" class="btn btn-success">Download
						    	<i class="glyphicon glyphicon-cloud-download"></i>
						    </button>
						  </div>
						</div>
					</form>
				</div>
				<div class="col-md-6">
					<iframe src="outlook-email-signature.htm" width="600px" height="280px" frameBorder="0" class="zoom"></iframe>
				</div>
			</div>
			<hr>
			<ol style="padding-left: 15px;" >
				<li>
					Modify content
				</li>
				<li>
					Download
				</li>
				<li>
					Go to Outlook singature folder : <br>
					<span class="unselect">Windows : </span>%AppData%\Microsoft\Signatures <br>
					<span class="unselect">Mac : </span>~/Documents/Microsoft User Data/Office 2017 Identities/Main identity/Data Records/Signatures
				</li>
				<li>
					Move downloaded singature file("niteco-signature.htm") to this folder
				</li>
				<li>
					Restart Outlook
				</li>
				<li>
					After restart, you can select new singature : "niteco-signature"
				</li>
			</ol>
		</div>
	</body>
	<script type="text/javascript">
		document.querySelector("iframe").addEventListener("load",function(){
			console.log("loaded");
			let iframeDoc = document.querySelector("iframe").contentDocument;
			document.querySelectorAll("input").forEach(function(ele,i){
				let targetId = ele.getAttribute("target");
				let targetEle = iframeDoc.querySelector(targetId);
				console.log(targetId,targetEle);
				ele.value = targetEle.innerHTML;
				ele.addEventListener("input",function(e){
					targetEle.innerHTML = e.target.value;
				})
			});
		});
		document.querySelector("#download").addEventListener("click",function(e){
			e.preventDefault();
			let fileName = "niteco-signature.htm",
				mimeType = 'text/plain',
				data = document.querySelector("iframe").contentDocument.body.innerHTML;
			var link = document.createElement('a');
			link.setAttribute('download', fileName);
			link.setAttribute('href', 'data:' + mimeType + ';charset=utf-8,' + encodeURIComponent(data));
			link.click(); 
		})
	</script>		
</html>
